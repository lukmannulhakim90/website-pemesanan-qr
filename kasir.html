<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Kasir - Luvium Cafe</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        /* Style Khusus Dashboard Kasir */
        body { font-family: 'Poppins', sans-serif; background: #f4f7f6; color: #333; padding: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .logo { font-size: 1.5rem; font-weight: bold; color: #A67B5B; }
        .btn-refresh { background: #A67B5B; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn-refresh:hover { background: #8E694D; }
        
        /* Grid Kartu Pesanan */
        .orders-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        
        .order-card { background: white; border-radius: 10px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-left: 5px solid #A67B5B; position: relative; }
        .order-header { display: flex; justify-content: space-between; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .table-badge { background: #333; color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.8rem; }
        .order-time { font-size: 0.8rem; color: #888; }
        
        .order-items { margin-bottom: 15px; max-height: 200px; overflow-y: auto; }
        .order-item { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.9rem; }
        
        .order-total { font-weight: bold; font-size: 1.1rem; text-align: right; margin-bottom: 15px; color: #A67B5B; }
        
        .actions { display: flex; gap: 10px; }
        .btn-done { flex: 1; background: #28a745; color: white; border: none; padding: 8px; border-radius: 5px; cursor: pointer; }
        .btn-delete { background: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; }
        
        .empty-state { grid-column: 1/-1; text-align: center; padding: 50px; color: #999; }
    </style>
</head>
<body>

    <div class="header">
        <div class="logo"><i class="fa-solid fa-mug-hot"></i> Luvium Kasir</div>
        <div>
            <button class="btn-refresh" onclick="loadOrders()"><i class="fa-solid fa-rotate"></i> Refresh Data</button>
            <button class="btn-refresh" onclick="clearAllData()" style="background: #dc3545; margin-left: 10px;">Reset Semua</button>
        </div>
    </div>

    <div id="ordersContainer" class="orders-grid">
        </div>

    <script>
        // === LOGIKA DASHBOARD KASIR ===
        
        // 1. Load data saat halaman dibuka
        document.addEventListener('DOMContentLoaded', loadOrders);

        // Agar otomatis refresh setiap 5 detik (opsional)
        setInterval(loadOrders, 5000); 

        function loadOrders() {
            const container = document.getElementById('ordersContainer');
            // Ambil data dari LocalStorage (yang disimpan oleh halaman pelanggan)
            const orders = JSON.parse(localStorage.getItem('luvium_orders')) || [];

            container.innerHTML = '';

            if (orders.length === 0) {
                container.innerHTML = '<div class="empty-state"><h2>Belum ada pesanan masuk</h2></div>';
                return;
            }

            // Urutkan pesanan terbaru paling atas
            orders.reverse().forEach((order, index) => {
                // Hitung ulang index asli sebelum di-reverse agar tombol hapus akurat
                const originalIndex = orders.length - 1 - index;
                
                const card = document.createElement('div');
                card.className = 'order-card';
                
                // Render Item List
                let itemsHtml = '';
                order.items.forEach(item => {
                    itemsHtml += `
                        <div class="order-item">
                            <span>${item.quantity}x ${item.name}</span>
                            <span>${(item.price * item.quantity).toLocaleString('id-ID')}</span>
                        </div>
                    `;
                });

                card.innerHTML = `
                    <div class="order-header">
                        <div>
                            <div style="font-weight:bold; font-size:1.1rem">${order.customerName}</div>
                            <div class="order-time">${order.timestamp}</div>
                        </div>
                        <span class="table-badge">Meja ${order.tableNumber}</span>
                    </div>
                    <div class="order-items">
                        ${itemsHtml}
                    </div>
                    <div class="order-total">Total: Rp ${order.total.toLocaleString('id-ID')}</div>
                    <div class="actions">
                        <button class="btn-done" onclick="markAsDone(${originalIndex})"><i class="fa-solid fa-check"></i> Selesai/Bayar</button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Fungsi menyelesaikan pesanan (Hapus dari daftar)
        function markAsDone(index) {
            if(confirm('Apakah pesanan ini sudah dibayar/selesai?')) {
                let orders = JSON.parse(localStorage.getItem('luvium_orders')) || [];
                orders.splice(index, 1); // Hapus pesanan dari array
                localStorage.setItem('luvium_orders', JSON.stringify(orders)); // Simpan lagi
                loadOrders(); // Refresh tampilan
            }
        }

        // Fungsi Reset Darurat (Hapus semua)
        function clearAllData() {
            if(confirm('Hapus SEMUA riwayat pesanan?')) {
                localStorage.removeItem('luvium_orders');
                loadOrders();
            }
        }
    </script>
</body>
</html>